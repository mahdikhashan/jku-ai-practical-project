/tmp/tmprptoruas/main.c:4:10: fatal error: Python.h: No such file or directory
    4 | #include <Python.h>
      |          ^~~~~~~~~~
compilation terminated.

---------------------------------------------------------------------------
CalledProcessError                        Traceback (most recent call last)
Cell In[5], line 1
----> 1 profile_triton(32)

Cell In[4], line 12
      9 A = torch.randn((M, K), device="cuda", dtype=torch.float32)
     10 B = torch.randn((K, N), device="cuda", dtype=torch.float32)
---> 12 C = matmul_triton_naive(A, B)
     14 profiler.disable()
     15 stats = pstats.Stats(profiler).sort_stats('tottime')

Cell In[3], line 33
     29         sum += a * b
     31     tl.store(C + m*N + n, sum)
---> 33 kernel[grid](
     34     A, B, C,
     35     M, N, K,
     36 )
     38 return C

File <string>:63, in kernel(A, B, C, M, N, K, grid, num_warps, num_stages, extern_libs, stream, warmup, device, device_type)

File ~/.local/lib/python3.9/site-packages/triton/compiler/compiler.py:425, in compile(fn, **kwargs)
    423 # cache manager
    424 if is_cuda or is_hip:
--> 425     so_path = make_stub(name, signature, constants)
    426 else:
    427     so_path = _device_backend.make_launcher_stub(name, signature, constants)

File ~/.local/lib/python3.9/site-packages/triton/compiler/make_launcher.py:39, in make_stub(name, signature, constants)
     37 with open(src_path, "w") as f:
     38     f.write(src)
---> 39 so = _build(name, src_path, tmpdir)
     40 with open(so, "rb") as f:
     41     return so_cache_manager.put(f.read(), so_name, binary=True)

File ~/.local/lib/python3.9/site-packages/triton/common/build.py:90, in _build(name, src, srcdir)
     88     cc_cmd = [cc, src, "-O3", f"-I{cu_include_dir}", f"-I{py_include_dir}", f"-I{srcdir}", "-shared", "-fPIC", "-lcuda", "-o", so]
     89     cc_cmd += [f"-L{dir}" for dir in cuda_lib_dirs]
---> 90     ret = subprocess.check_call(cc_cmd)
     92 if ret == 0:
     93     return so

File /usr/lib64/python3.9/subprocess.py:373, in check_call(*popenargs, **kwargs)
    371     if cmd is None:
    372         cmd = popenargs[0]
--> 373     raise CalledProcessError(retcode, cmd)
    374 return 0

CalledProcessError: Command '['/usr/bin/gcc', '/tmp/tmprptoruas/main.c', '-O3', '-I/system/user/khashan/.local/lib/python3.9/site-packages/triton/common/../third_party/cuda/include', '-I/usr/include/python3.9', '-I/tmp/tmprptoruas', '-shared', '-fPIC', '-lcuda', '-o', '/tmp/tmprptoruas/kernel.cpython-39-x86_64-linux-gnu.so', '-L/lib64', '-L/lib', '-L/lib64', '-L/lib']' returned non-zero exit status 1.